%% -*- mode: erlang -*-
%% Copyright (c) 2023 Peter Morgan <peter.james.morgan@gmail.com>
%%
%% Licensed under the Apache License, Version 2.0 (the "License");
%% you may not use this file except in compliance with the License.
%% You may obtain a copy of the License at
%%
%% http://www.apache.org/licenses/LICENSE-2.0
%%
%% Unless required by applicable law or agreed to in writing, software
%% distributed under the License is distributed on an "AS IS" BASIS,
%% WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
%% See the License for the specific language governing permissions and
%% limitations under the License.

{#{packet => #{action => handshake,
               capability_flags_1 => #{interactive => true,
                                       ssl => true,
                                       compress => true,
                                       protocol_41 => true,
                                       transactions => true,
                                       reserved => true,
                                       reserved2 => true,
                                       ignore_sigpipe => true,
                                       ignore_space => true,
                                       local_files => true,
                                       odbc => true,
                                       no_schema => true,
                                       connect_with_db => true,
                                       long_flag => true,
                                       found_rows => true,
                                       long_password => true},
               capability_flags_2 => #{mfa => true,
                                       session_track => true,
                                       plugin_auth => true,
                                       connect_attrs => true,
                                       query_attributes => true,
                                       optional_resultset_metadata => true,
                                       remember_options => true,
                                       ssl_verify_cert => true,
                                       capability_extension => false,
                                       zstd_compression => true,
                                       deprecate_eof => true,
                                       can_handle_expired_passwords => true,
                                       plugin_auth_lenenc_client_data => true,
                                       ps_multi_results => true,
                                       multi_results => true,
                                       multi_statements => true},
               server_version => <<"8.0.34">>,
               thread_id => 13,
               auth_plugin_data_part_1 => <<25,8,71,123,107,99,33,108>>,
               filler => 0,
               character_set => 255,
               status_flags => 2,
               auth_plugin_data_len => 21,
               reserved => <<0,0,0,0,0,0,0,0,0,0>>,
               auth_plugin_data_part_2 => <<90,62,37,105,96,22,99,101,63,78,69,91,0>>,
               auth_plugin_name => caching_sha2_password},
   sequence => 0},
 <<74,0,0,0,
   10,
   56,46,48,46,51,52,0,
   13,0,0,0,
   25,8,71,123,107,99,33,108,
   0,
   255,255,
   255,
   2,0,
   255,223,
   21,
   0,0,0,0,0,0,0,0,0,0,
   90,62,37,105,96,22,99,101,63,78,69,91,0,99,
   97,99,104,105,110,103,95,115,104,97,50,95,112,97,115,
   115,119,111,114,100,0>>}.

{#{packet => #{action => handshake,server_version => <<"8.0.33">>,
                     thread_id => 9,
                     auth_plugin_data_part_1 => <<"F~7\vL3zx">>,filler => 0,
                     capability_flags_1 =>
                         #{interactive => true,ssl => true,compress => true,
                           reserved => true,protocol_41 => true,
                           transactions => true,reserved2 => true,
                           ignore_sigpipe => true,ignore_space => true,
                           local_files => true,odbc => true,no_schema => true,
                           connect_with_db => true,long_flag => true,
                           found_rows => true,long_password => true},
                     character_set => 255,status_flags => 2,
                     capability_flags_2 =>
                         #{mfa => true,plugin_auth => true,
                           session_track => true,connect_attrs => true,
                           query_attributes => true,
                           optional_resultset_metadata => true,
                           remember_options => true,ssl_verify_cert => true,
                           capability_extension => false,
                           zstd_compression => true,deprecate_eof => true,
                           can_handle_expired_passwords => true,
                           plugin_auth_lenenc_client_data => true,
                           ps_multi_results => true,multi_results => true,
                           multi_statements => true},
                     auth_plugin_data_len => 21,
                     reserved => <<0,0,0,0,0,0,0,0,0,0>>,
                     auth_plugin_data_part_2 =>
                         <<106,37,52,75,37,79,78,66,30,27,44,110,0>>,
                     auth_plugin_name => caching_sha2_password},
               sequence => 0},
 <<74,0,0,0,10,56,46,48,46,51,51,0,9,0,0,0,70,126,55,11,76,51,122,120,0,255,
   255,255,2,0,255,223,21,0,0,0,0,0,0,0,0,0,0,106,37,52,75,37,79,78,66,30,27,
   44,110,0,99,97,99,104,105,110,103,95,115,104,97,50,95,112,97,115,115,119,
   111,114,100,0>>}.


{#{packet => #{action => handshake,
               reserved => <<0,0,0,0,0,0,0,0,0,0>>,
               character_set => 255,
               server_version => <<"8.0.34">>,
               thread_id => 8,
               auth_plugin_data_part_1 => <<29,74,110,7,55,64,13,68>>,
               filler => 0,
               capability_flags_1 => #{interactive => true,
                                       ssl => true,
                                       compress => true,
                                       reserved2 => true,
                                       reserved => true,
                                       transactions => true,
                                       ignore_sigpipe => true,
                                       protocol_41 => true,
                                       ignore_space => true,
                                       local_files => true,
                                       odbc => true,
                                       no_schema => true,
                                       connect_with_db => true,
                                       long_flag => true,
                                       found_rows => true,
                                       long_password => true},
               status_flags => 2,
               capability_flags_2 => #{mfa => true,
                                       remember_options => true,
                                       ssl_verify_cert => true,
                                       capability_extension => false,
                                       query_attributes => true,
                                       zstd_compression => true,
                                       optional_resultset_metadata => true,
                                       deprecate_eof => true,
                                       session_track => true,
                                       can_handle_expired_passwords => true,
                                       plugin_auth_lenenc_client_data => true,
                                       connect_attrs => true,
                                       plugin_auth => true,
                                       ps_multi_results => true,
                                       multi_results => true,
                                       multi_statements => true},
               auth_plugin_data_len => 21,
               auth_plugin_data_part_2 => <<106,55,61,103,69,81,86,102,117,31,58,75,0>>,
               auth_plugin_name => mysql_native_password},
   sequence => 0},
 <<74,0,0,0,
   10,
   56,46,48,46,51,52,0,
   8,0,0,0,
   29,74,110,7,55,64,13,68,
   0,
   255,255,
   255,
   2,0,
   255,223,
   21,
   0,0,0,0,0,0,0,0,0,0,
   106,55,61,103,69,81,86,102,117,31,58,75,0,
   109,121,115,113,108,95,110,97,116,105,118,101,95,112,97,115,115,119,111,114,100,0>>}.

{#{packet => #{action => handshake,
               character_set => 45,
               capability_flags_1 =>
                   #{interactive => true,ssl => false,compress => true,
                     protocol_41 => true,transactions => true,
                     reserved => true,connect_with_db => true,
                     reserved2 => true,ignore_sigpipe => true,
                     ignore_space => true,local_files => true,
                     odbc => true,no_schema => true,long_flag => true,
                     found_rows => true,long_password => false},
               capability_flags_2 =>
                   #{mfa => false,session_track => true,
                     plugin_auth => true,connect_attrs => true,
                     plugin_auth_lenenc_client_data => true,
                     zstd_compression => false,remember_options => true,
                     ssl_verify_cert => false,
                     capability_extension => false,
                     query_attributes => false,
                     optional_resultset_metadata => false,
                     deprecate_eof => true,
                     can_handle_expired_passwords => true,
                     ps_multi_results => true,multi_results => true,
                     multi_statements => true},
               server_version =>
                   <<"11.1.2-MariaDB-1:11.1.2+maria~ubu2204-log">>,
               thread_id => 3,auth_plugin_data_part_1 => <<"h')9!89Q">>,
               filler => 0,status_flags => 2,auth_plugin_data_len => 21,
               reserved => <<0,0,0,0,0,0>>,
               capability_flags_3 => 29,
               auth_plugin_data_part_2 =>
                   <<109,80,40,116,53,71,69,100,74,38,123,91,0>>,
               auth_plugin_name => mysql_native_password},
   sequence => 0},
 <<109,0,0,
   0,
   10,
   49,49,46,49,46,50,45,77,97,114,105,97,68,66,45,49,
   58,49,49,46,49,46,50,43,109,97,114,105,97,126,117,98,117,50,50,
   48,52,45,108,111,103,0,
   3,0,0,0,
   104,39,41,57,33,56,57,81,
   0,
   254,247,
   45,
   2,0,
   255,129,
   21,
   0,0,0,0,0,0,
   29,0,0,0,
   109,80,40,116,53,71,69,100,74,38,123,91,0,
   109,121,115,113,108,95,110,97,116,105,118,
   101,95,112,97,115,115,119,111,114,100,0>>}.
