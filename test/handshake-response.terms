%% -*- mode: erlang -*-
%% Copyright (c) 2023 Peter Morgan <peter.james.morgan@gmail.com>
%%
%% Licensed under the Apache License, Version 2.0 (the "License");
%% you may not use this file except in compliance with the License.
%% You may obtain a copy of the License at
%%
%% http://www.apache.org/licenses/LICENSE-2.0
%%
%% Unless required by applicable law or agreed to in writing, software
%% distributed under the License is distributed on an "AS IS" BASIS,
%% WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
%% See the License for the specific language governing permissions and
%% limitations under the License.

{#{packet => #{action => handshake_response,
               connect_attrs => #{<<"_client_name">> => <<"libmysql">>,
                                  <<"_client_version">> => <<"8.0.34">>,
                                  <<"_os">> => <<"Linux">>,<<"_pid">> => <<"276">>,
                                  <<"_platform">> => <<"aarch64">>,
                                  <<"os_user">> => <<"root">>,
                                  <<"program_name">> => <<"mysql">>},
               client_flags => #{interactive => true,
                                 ssl => false,
                                 compress => false,
                                 mfa => true,
                                 remember_options => false,
                                 ssl_verify_cert => false,
                                 capability_extension => false,
                                 query_attributes => true,
                                 zstd_compression => false,
                                 optional_resultset_metadata => false,
                                 deprecate_eof => true,
                                 session_track => true,
                                 can_handle_expired_passwords => true,
                                 plugin_auth_lenenc_client_data => true,
                                 connect_attrs => true,
                                 plugin_auth => true,
                                 ps_multi_results => true,
                                 multi_results => true,
                                 multi_statements => true,
                                 reserved2 => true,
                                 reserved => false,
                                 transactions => true,
                                 ignore_sigpipe => false,
                                 protocol_41 => true,
                                 ignore_space => false,
                                 local_files => true,
                                 odbc => false,
                                 no_schema => false,
                                 connect_with_db => false,
                                 long_flag => true,
                                 found_rows => false,
                                 long_password => true},
               character_set => 8,
               auth_response => <<69,141,33,190,107,186,56,64,54,147,2,199,90,135,117,
                                  38,178,52,105,225,195,186,202,11,126,22,82,218,164,
                                  225,146,225>>,
               client_plugin_name => caching_sha2_password,
               max_packet_size => 16777216,
               username => <<"root">>},
   sequence => 1},
 <<207,0,0,
   1,
   133,166,255,25,
   0,0,0,1,
   8,
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   114,111,111,116,0,
   32,69,
   141,33,190,107,186,56,64,54,147,2,199,90,135,117,38,
   178,52,105,225,195,186,202,11,126,22,82,218,164,225,
   146,225,99,97,99,104,105,110,103,95,115,104,97,50,95,
   112,97,115,115,119,111,114,100,0,114,4,95,112,105,
   100,3,50,55,54,9,95,112,108,97,116,102,111,114,109,7,
   97,97,114,99,104,54,52,3,95,111,115,5,76,105,110,117,
   120,12,95,99,108,105,101,110,116,95,110,97,109,101,8,
   108,105,98,109,121,115,113,108,7,111,115,95,117,115,
   101,114,4,114,111,111,116,15,95,99,108,105,101,110,
   116,95,118,101,114,115,105,111,110,6,56,46,48,46,51,
   52,12,112,114,111,103,114,97,109,95,110,97,109,101,5,
   109,121,115,113,108>>}.


{#{packet => #{action => handshake_response,
               database => <<20,171,9,238,246,188,177,50,62,97,20,56,101,192,153,
                             29,149,125,117,212,71,116,101,115,116>>,
               client_flags => #{interactive => true,
                                 ssl => false,
                                 compress => false,
                                 mfa => false,
                                 remember_options => false,
                                 ssl_verify_cert => false,
                                 capability_extension => false,
                                 query_attributes => false,
                                 zstd_compression => false,
                                 optional_resultset_metadata => false,
                                 deprecate_eof => false,
                                 session_track => false,
                                 can_handle_expired_passwords => false,
                                 plugin_auth_lenenc_client_data => false,
                                 connect_attrs => false,
                                 plugin_auth => true,
                                 ps_multi_results => true,
                                 multi_results => true,
                                 multi_statements => true,
                                 reserved2 => true,
                                 reserved => false,
                                 transactions => true,
                                 ignore_sigpipe => false,
                                 protocol_41 => true,
                                 ignore_space => false,
                                 local_files => true,
                                 odbc => false,
                                 no_schema => false,
                                 connect_with_db => true,
                                 long_flag => true,
                                 found_rows => false,
                                 long_password => true},
               character_set => 8,
               client_plugin_name => mysql_native_password,
               max_packet_size => 16777216,
               username => <<"pam">>},
   sequence => 1},

 <<16#54, 16#00, 16#00, 16#01, 16#8d, 16#a6, 16#0f, 16#00, 16#00,
   16#00, 16#00, 16#01, 16#08, 16#00, 16#00, 16#00, 16#00, 16#00,
   16#00, 16#00, 16#00, 16#00, 16#00, 16#00, 16#00, 16#00, 16#00,
   16#00, 16#00, 16#00, 16#00, 16#00, 16#00, 16#00, 16#00, 16#00,
   16#70, 16#61, 16#6d, 16#00, 16#14, 16#ab, 16#09, 16#ee, 16#f6,
   16#bc, 16#b1, 16#32, 16#3e, 16#61, 16#14, 16#38, 16#65, 16#c0,
   16#99, 16#1d, 16#95, 16#7d, 16#75, 16#d4, 16#47, 16#74, 16#65,
   16#73, 16#74, 16#00, 16#6d, 16#79, 16#73, 16#71, 16#6c, 16#5f,
   16#6e, 16#61, 16#74, 16#69, 16#76, 16#65, 16#5f, 16#70, 16#61,
   16#73, 16#73, 16#77, 16#6f, 16#72, 16#64, 16#00>>}.


{#{packet => #{action => handshake_response,
               connect_attrs => #{<<"_client_name">> => <<"libmysql">>,
                                  <<"_client_replication_channel_name">> => <<>>,
                                  <<"_client_role">> => <<"binary_log_listener">>,
                                  <<"_client_version">> => <<"8.0.34">>,
                                  <<"_os">> => <<"Linux">>,
                                  <<"_pid">> => <<"1">>,
                                  <<"_platform">> => <<"aarch64">>,
                                  <<"program_name">> => <<"mysqld">>},
               client_flags => #{interactive => false,
                                 ssl => false,
                                 compress => false,
                                 mfa => true,
                                 remember_options => true,
                                 ssl_verify_cert => false,
                                 capability_extension => false,
                                 query_attributes => true,
                                 zstd_compression => false,
                                 optional_resultset_metadata => false,
                                 deprecate_eof => true,
                                 session_track => true,
                                 can_handle_expired_passwords => false,
                                 plugin_auth_lenenc_client_data => true,
                                 connect_attrs => true,
                                 plugin_auth => true,
                                 ps_multi_results => false,
                                 multi_results => false,
                                 multi_statements => false,
                                 reserved2 => true,
                                 reserved => false,
                                 transactions => true,
                                 ignore_sigpipe => false,
                                 protocol_41 => true,
                                 ignore_space => false,
                                 local_files => true,
                                 odbc => false,
                                 no_schema => false,
                                 connect_with_db => false,
                                 long_flag => true,
                                 found_rows => false,
                                 long_password => true},
               character_set => 255,
               auth_response => <<80,186,255,233,144,242,166,104,203,131,200,85,137,
                                  249,137,222,60,221,234,83>>,
               client_plugin_name => mysql_native_password,
               max_packet_size => 1073746021,
               username => <<"root">>},
   sequence => 1},
 <<248,0,0,
   1,
   133,162,184,153,
   101,16,0,64,
   255,
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   114,111,111,116,
   0,20,80,186,255,233,144,242,166,104,203,131,200,85,
   137,249,137,222,60,221,234,83,109,121,115,113,108,95,
   110,97,116,105,118,101,95,112,97,115,115,119,111,114,
   100,0,167,9,95,112,108,97,116,102,111,114,109,7,97,
   97,114,99,104,54,52,3,95,111,115,5,76,105,110,117,
   120,12,95,99,108,105,101,110,116,95,110,97,109,101,8,
   108,105,98,109,121,115,113,108,32,95,99,108,105,101,
   110,116,95,114,101,112,108,105,99,97,116,105,111,110,
   95,99,104,97,110,110,101,108,95,110,97,109,101,0,4,
   95,112,105,100,1,49,12,95,99,108,105,101,110,116,95,
   114,111,108,101,19,98,105,110,97,114,121,95,108,111,
   103,95,108,105,115,116,101,110,101,114,15,95,99,108,
   105,101,110,116,95,118,101,114,115,105,111,110,6,56,
   46,48,46,51,52,12,112,114,111,103,114,97,109,95,110,
   97,109,101,6,109,121,115,113,108,100>>}.

{#{packet => #{action => handshake_response,
               client_flags => #{can_handle_expired_passwords => true,
                                 capability_extension => true,
                                 compress => false,
                                 connect_attrs => true,
                                 connect_with_db => false,
                                 deprecate_eof => false,
                                 found_rows => false,
                                 ignore_sigpipe => false,
                                 ignore_space => false,
                                 interactive => true,
                                 local_files => true,
                                 long_flag => true,
                                 long_password => false,
                                 mfa => false,
                                 multi_results => true,
                                 multi_statements => true,
                                 no_schema => false,
                                 odbc => false,
                                 optional_resultset_metadata => false,
                                 plugin_auth => true,
                                 plugin_auth_lenenc_client_data => true,
                                 protocol_41 => true,
                                 ps_multi_results => true,
                                 query_attributes => false,
                                 remember_options => false,
                                 reserved => false,
                                 reserved2 => true,
                                 session_track => true,
                                 ssl => false,
                                 ssl_verify_cert => false,
                                 transactions => true,
                                 zstd_compression => false},
               character_set => 33,
               connect_attrs => #{<<"_client_name">> => <<"libmariadb">>,
                                  <<"_client_version">> => <<"3.3.6">>,
                                  <<"_os">> => <<"Linux">>,<<"_pid">> => <<"166">>,
                                  <<"_platform">> => <<"aarch64">>,
                                  <<"_server_host">> => <<"m0">>,
                                  <<"program_name">> => <<"mysql">>},
               auth_response => <<54,174,72,124,177,221,187,60,111,87,198,168,140,106,
                                  33,120,27,29,95,115>>,
               client_plugin_name => mysql_native_password,
               max_packet_size => 16777216,
               username => <<"root">>,
               extended_capabilities => 29},
   sequence => 1},
 <<199,0,0,
   1,
   132,166,255,32,
   0,0,0,1,
   33,
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,    %% string<19> reserved
   29,0,0,0,                                 %% extended cap/string<4>
   114,111,111,116,0,
   20,54,174,72,124,177,221,187,60,111,
   87,198,168,140,106,33,120,27,29,95,115,109,121,115,113,108,95,110,97,
   116,105,118,101,95,112,97,115,115,119,111,114,100,0,118,3,95,111,115,
   5,76,105,110,117,120,12,95,99,108,105,101,110,116,95,110,97,109,101,
   10,108,105,98,109,97,114,105,97,100,98,4,95,112,105,100,3,49,54,54,
   15,95,99,108,105,101,110,116,95,118,101,114,115,105,111,110,5,51,46,
   51,46,54,9,95,112,108,97,116,102,111,114,109,7,97,97,114,99,104,54,
   52,12,112,114,111,103,114,97,109,95,110,97,109,101,5,109,121,115,113,
   108,12,95,115,101,114,118,101,114,95,104,111,115,116,2,109,48>>}.
